(function(i,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(i=typeof globalThis<"u"?globalThis:i||self,l(i.GoogleCustomEventTracker={}))})(this,function(i){"use strict";var l=typeof document<"u"?document.currentScript:null;function C(n,t){try{const e=document.querySelectorAll(n);return e.length===1&&e[0]===t}catch{return!1}}function m(n){if(!(n instanceof Element))return null;if(n.id)return`#${CSS.escape(n.id)}`;const t=[];if(n.tagName.toLowerCase(),n.classList.length){const o=n.classList[0];t.push(`.${CSS.escape(o)}`)}Array.from(n.attributes).forEach(o=>{o.name.startsWith("data-")&&t.push(`[${o.name}]`)});const e=t[0];if(e&&C(e,n))return e;const r=[];let a=n;for(;a&&a.nodeType===Node.ELEMENT_NODE;){const o=a.parentElement,u=a.tagName.toLowerCase();let d="";if(o){const p=Array.from(o.children).filter(w=>w.tagName.toLowerCase()===u);p.length>1&&(d=`:nth-of-type(${p.indexOf(a)+1})`)}r.unshift(`${u}${d}`),a=o}return r.join(" > ")||null}function f(n){switch(n.nodeType){case Node.DOCUMENT_NODE:return"/";case Node.DOCUMENT_TYPE_NODE:return"/html/doctype";case Node.ELEMENT_NODE:{const t=n;if(t.id)return`//*[@id="${CSS.escape(t.id)}"]`;if(t.tagName.toLowerCase()==="html")return"/html";if(t===document.head)return"/html/head";if(t===document.body)return"/html/body";const e=t.parentNode;if(!e)return"";const r=t.tagName.toLowerCase(),a=Array.from(e.children).filter(u=>u.tagName.toLowerCase()===r),o=a.length>1?`[${a.indexOf(t)+1}]`:"";return`${f(e)}/${r}${o}`}case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:case Node.COMMENT_NODE:{const t=n.parentNode;if(!t)return"";const e={[Node.TEXT_NODE]:"text()",[Node.CDATA_SECTION_NODE]:"text()",[Node.COMMENT_NODE]:"comment()"},r=Array.from(t.childNodes).filter(o=>o.nodeType===n.nodeType),a=r.length>1?`[${r.indexOf(n)+1}]`:"";return`${f(t)}/${e[n.nodeType]}${a}`}default:return""}}let s=null,c=null;const y=50,T=5e3,N=typeof{url:typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:l&&l.tagName.toUpperCase()==="SCRIPT"&&l.src||new URL("google-custom-event-tracker.umd.js",document.baseURI).href}<"u"&&!1,h={mouseUp:!1,mouseDown:!1,click:!0,contextMenu:!0,dblClick:!0,focus:!0,blur:!0,touchStart:!0,touchEnd:!0,touchCancel:!0,input:!0,play:!0,pause:!0,seeked:!0,volumeChange:!0,rateChange:!0};function g(n={}){const t={send:e=>{console.log("Event tracked:",e)},captureText:!0,captureSelector:!0,capturePath:!0,captureXPath:!0,events:{...h,...n.events},...n};console.log(`initTracker: ${JSON.stringify(t)}`),s&&Object.keys(h).forEach(e=>{const r=e==="dblClick"?"dblclick":e==="volumeChange"?"volumechange":e==="rateChange"?"ratechange":e.toLowerCase();document.removeEventListener(r,s)}),s=e=>{var d;const r=e.target;if(!r)return;const a=e.type==="dblclick"?"dblClick":e.type==="volumechange"?"volumeChange":e.type==="ratechange"?"rateChange":Object.keys(h).find(p=>p.toLowerCase()===e.type);if(!a||!t.events[a])return;const o={type:e.type,tag:r.tagName.toLowerCase(),ts:Date.now()};t.captureText&&(o.text=r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement?r.value:((d=r.textContent)==null?void 0:d.trim())||null);let u=null;t.captureSelector&&(u=m(r),o.selector=u),t.capturePath&&(o.path=u??m(r)),t.captureXPath&&(o.xpath=f(r)),t.send(o)},Object.entries(t.events).forEach(([e,r])=>{if(!r)return;const a=e==="dblClick"?"dblclick":e==="volumeChange"?"volumechange":e==="rateChange"?"ratechange":e.toLowerCase();document.addEventListener(a,s)})}function E(){if(typeof window>"u")return;c&&clearInterval(c);let n=0;c=setInterval(()=>{if(typeof window>"u"){clearInterval(c),c=null;return}n+=y;const t=window.gtag,e=window.dataLayer,r=Array.isArray(e)&&typeof e.push=="function";if(typeof t=="function"||r){clearInterval(c),c=null,g({send:a=>{typeof t=="function"?t("event","ui_event",a):e.push({event:"ui_event",...a})}});return}n>=T&&(clearInterval(c),c=null,console.warn("[GCE] gtag did not initialize in time â€” tracking disabled"))},y)}function v(){s&&(Object.keys(h).forEach(n=>{const t=n==="dblClick"?"dblclick":n==="volumeChange"?"volumechange":n==="rateChange"?"ratechange":n.toLowerCase();document.removeEventListener(t,s)}),s=null),c&&(clearInterval(c),c=null)}typeof window<"u"&&!N&&E();const b={init:g};i._resetTrackerForTests=v,i.buildSelector=m,i.buildXPath=f,i.default=b,i.initTracker=g,i.startAutoInit=E,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=google-custom-event-tracker.umd.js.map
