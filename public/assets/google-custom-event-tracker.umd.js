(function(g,C){typeof exports=="object"&&typeof module<"u"?C(exports):typeof define=="function"&&define.amd?define(["exports"],C):(g=typeof globalThis<"u"?globalThis:g||self,C(g.GoogleCustomEventTracker={}))})(this,function(g){"use strict";var C=typeof document<"u"?document.currentScript:null;const E={ANCHOR:.4,PATH:.3,TARGET:.2,UNIQUENESS:.1},p={SEMANTIC_TAG:.5,ROLE:.3,ARIA_LABEL:.1,STABLE_ID:.25,TEST_MARKER:.05,DEPTH_PENALTY_THRESHOLD:5,DEPTH_PENALTY_FACTOR:.05,DEGRADED_SCORE:.3},ee={MIN_CONFIDENCE_FOR_SKIP:.7},N=["form","main","nav","section","article","footer","header"],I=["form","navigation","main","region","contentinfo","complementary","banner","search"],te=["article","aside","details","figcaption","figure","footer","header","main","mark","nav","section","summary","time","button","datalist","fieldset","form","input","label","legend","meter","optgroup","option","output","progress","select","textarea","a","audio","video","canvas","dialog","menu","blockquote","dd","dl","dt","hr","li","ol","ul","p","pre","h1","h2","h3","h4","h5","h6","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr","svg","path","circle","rect","line","polyline","polygon","ellipse","g","text","use"],y={"data-testid":100,"data-qa":99,"data-cy":98,"data-test":97,"data-test-id":96,"aria-label":90,"aria-labelledby":85,"aria-describedby":80,name:75,href:70,src:70,type:65,role:60,alt:55,title:50,for:45,placeholder:40,"data-*":30,"aria-*":25},_=new Set(["id","class","style","xmlns","tabindex","contenteditable"]),ae={maxPathDepth:10,enableSvgFingerprint:!0,confidenceThreshold:0,fallbackToBody:!0,includeUtilityClasses:!1,source:"dom-dsl"};function v(a){return!!(/^[a-z]+-\d+$/i.test(a)||/^[a-z]+(-[a-z]+)+-\d+$/i.test(a)||/^[a-z]+(_[a-z]+)*_\d+$/i.test(a)||/^\d+$/.test(a)||/^:[a-z0-9]+:$/i.test(a)||/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i.test(a)||/^[a-z]{1,3}[A-Za-z0-9]{8,}$/.test(a)&&(/\d/.test(a)||/[A-Z]/.test(a))||/^radix-/.test(a)||/^mui-\d+$/.test(a))}const O=new Set(["aria-labelledby","aria-describedby","aria-controls","aria-owns","aria-activedescendant","for","form","list","headers","aria-details","aria-errormessage","aria-flowto"]);function P(a){return a.trim().split(/\s+/).some(e=>v(e))}class se{constructor(e,t){this.maxDepth=e.maxPathDepth??10,this.cache=t}findAnchor(e){if(this.cache){const l=this.cache.getAnchor(e);if(l!==void 0)return l}const t=e.tagName.toLowerCase(),s=e.ownerDocument;if(t==="html"){const l={element:e,score:1,tier:"A",depth:0};return this.cacheResult(e,l),l}if(t==="head"||this.isInsideHead(e)){const l=s==null?void 0:s.documentElement;if(l){const d={element:l,score:1,tier:"A",depth:0};return this.cacheResult(e,d),d}}if(t==="body"){const l=s==null?void 0:s.documentElement;if(l){const d={element:l,score:1,tier:"A",depth:0};return this.cacheResult(e,d),d}}let r=e.parentElement,i=0,n=null;for(;r&&i<this.maxDepth;){if(r.tagName.toLowerCase()==="body")return n||{element:r,score:p.DEGRADED_SCORE,tier:"C",depth:i};const l=this.scoreAnchor(r);if(l>0){const d=this.applyDepthPenalty(l,i),h=this.getTier(r),c={element:r,score:d,tier:h,depth:i};if(h==="A")return c;(!n||d>n.score)&&(n=c)}r=r.parentElement,i++}const o=n;return this.cache&&this.cache.setAnchor(e,o),o}scoreAnchor(e){let t=0;const s=e.tagName.toLowerCase();N.includes(s)&&(t+=p.SEMANTIC_TAG);const r=e.getAttribute("role");r&&I.includes(r)&&(t+=p.ROLE),(e.hasAttribute("aria-label")||e.hasAttribute("aria-labelledby"))&&(t+=p.ARIA_LABEL);const i=e.id;return i&&!v(i)&&(t+=p.STABLE_ID),(e.hasAttribute("data-testid")||e.hasAttribute("data-qa")||e.hasAttribute("data-test"))&&(t+=p.TEST_MARKER),Math.min(t,1)}applyDepthPenalty(e,t){if(t<=p.DEPTH_PENALTY_THRESHOLD)return e;const s=(t-p.DEPTH_PENALTY_THRESHOLD)*p.DEPTH_PENALTY_FACTOR;return Math.max(0,e-s)}getTier(e){const t=e.tagName.toLowerCase();if(N.includes(t))return"A";const s=e.getAttribute("role");return s&&I.includes(s)?"B":"C"}isInsideHead(e){let t=e.parentElement;for(;t;){const s=t.tagName.toLowerCase();if(s==="head")return!0;if(s==="body")return!1;t=t.parentElement}return!1}cacheResult(e,t){this.cache&&this.cache.setAnchor(e,t)}}const re=[/^css-[a-z0-9]+$/i,/^sc-[a-z0-9]+-\d+$/i,/^[a-z]{5,8}$/i,/^Mui[A-Z]\w+-\w+-\w+/,/^makeStyles-\w+-\d+$/,/^jss\d+$/,/^(emotion|linaria)-[a-z0-9]+/i,/^(chakra|tw-|ant-)[a-z0-9]+-\w+/i,/-[a-f0-9]{6,}$/i,/^_[a-z0-9]{5,}$/i,/\d{5,}/],ie=[/^\[/,/^(first|last|odd|even|only|first-of-type|last-of-type|only-of-type):/,/^(hover|focus|active|disabled|enabled|checked|indeterminate|default|required|valid|invalid|in-range|out-of-range|placeholder-shown|autofill|read-only):/,/^(focus-within|focus-visible|visited|target|open):/,/^(sm|md|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl):/,/^dark:/,/^(rtl|ltr):/,/^(group|peer)(-hover|-focus|-active)?:/,/\/([\d.]+|full|auto|screen)$/,/^(inset|top|right|bottom|left)(-|$)/,/^(flex|inline-flex|grid|block|inline|inline-block|hidden|visible)$/,/^(absolute|relative|fixed|sticky|static)$/,/^(items|justify|content|self|place)-/,/^flex-(row|col|wrap|nowrap|1|auto|initial|none)/,/^grid-(cols|rows|flow)/,/^(gap|space)-/,/^[mp][trblxy]?-(\d+|auto|px)$/,/^-[mp][trblxy]?-\d+$/,/^-(top|right|bottom|left|inset)-\d+$/,/^-z-\d+$/,/^-space-[xy]-\d+$/,/^-translate-[xy]-\d+$/,/^-rotate-\d+$/,/^-scale-\d+$/,/^-skew-[xy]-\d+$/,/^(w|h|min-w|min-h|max-w|max-h|size)-/,/^text-(center|left|right|justify|start|end|xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/,/^text-(uppercase|lowercase|capitalize|normal-case|underline|line-through|no-underline)$/,/^text-(truncate|ellipsis|clip)$/,/^(bg|border|ring|shadow|outline)-/,/^rounded(-|$)/,/^(font|leading|tracking|whitespace|break|truncate)-/,/^(uppercase|lowercase|capitalize|normal-case)$/,/^(transform|transition|duration|delay|ease|animate)-/,/^(scale|rotate|translate|skew)-/,/^transform$/,/^backdrop-blur-/,/^motion-/,/^(fade|slide|zoom|bounce|pulse|spin|ping)-/,/^(overflow|overscroll|scroll)-/,/^object-(contain|cover|fill|none|scale-down)$/,/^(cursor|pointer-events|select|resize)-/,/^(opacity|z)-/,/^(visible|invisible|collapse)$/,/^d-(none|inline|inline-block|block|grid|table|flex)$/,/^(float|clearfix|text)-(left|right|center|justify|start|end)$/,/^(m|p)[trblxy]?-[0-5]$/,/^(w|h)-(25|50|75|100|auto)$/,/^btn-(sm|lg|block)$/,/^text-(muted|primary|success|danger|warning|info|light|dark|white)$/,/^bg-(primary|secondary|success|danger|warning|info|light|dark|white|transparent)$/,/^border(-top|-bottom|-left|-right)?(-0)?$/,/^rounded(-top|-bottom|-left|-right|-circle|-pill|-0)?$/,/^shadow(-sm|-lg|-none)?$/,/^(align|justify|order|flex)-(start|end|center|between|around|fill|grow|shrink)$/,/^col(-sm|-md|-lg|-xl)?(-\d+|-auto)?$/,/^row(-cols)?(-\d+)?$/,/^g[xy]?-[0-5]$/,/^(show|hide|invisible|visible)$/,/^(position|top|bottom|start|end)-(static|relative|absolute|fixed|sticky|-\d+)$/,/^(row|col)$/,/^clearfix$/,/^pull-(left|right)$/,/^float-(left|right|none)$/];function T(a){return re.some(e=>e.test(a))}function $(a){return a.length<=2||/^\d/.test(a)?!0:ie.some(e=>e.test(a))}function ne(a){return!T(a)&&!$(a)}function oe(a){return a.filter(e=>ne(e))}function ce(a){const e=[],t=[];for(const s of a)$(s)||T(s)?t.push(s):e.push(s);return{semantic:e,utility:t}}function F(a){return $(a)||T(a)}const j=a=>a.replace(/([#:.[\]@])/g,"\\$1");class le{constructor(e,t){this.maxDepth=e.maxPathDepth??10,this.cache=t}buildPath(e,t,s){const r=e.tagName.toLowerCase(),i=t.tagName.toLowerCase();if(r==="html"&&(i==="head"||i==="body"))return{path:[],degraded:!1};if(r==="html"&&this.isInsideHead(t))return this.buildHeadPath(e,t,s);const n=[];let o=t.parentElement;for(;o&&o!==e&&n.length<this.maxDepth;)n.unshift(o),o=o.parentElement;const l=n.length>=this.maxDepth&&o!==e;if(!l&&o!==e)return console.warn("[PathBuilder] Target is not a descendant of anchor"),{path:[],degraded:!0,degradationReason:"target-not-descendant-of-anchor"};let d=this.filterNoise(n);return d=this.ensureUniqueness(n,d,e,t,s),{path:d.map(h=>{const c=h.parentElement;let u;if(c){const f=Array.from(c.children).indexOf(h);f!==-1&&(u=f+1)}return{tag:h.tagName.toLowerCase(),semantics:s.extract(h),score:s.scoreElement(h),nthChild:u}}),degraded:l,degradationReason:l?"path-depth-overflow":void 0}}buildPathNodes(e,t,s){return this.buildPath(e,t,s).path}ensureUniqueness(e,t,s,r,i){const n=this.buildTestSelector(s,t,r);try{const o=r.ownerDocument;if(!o)return t;let l;if(this.cache){const h=this.cache.getSelectorResults(n);h!==void 0?l=h:(l=Array.from(o.querySelectorAll(n)),this.cache.setSelectorResults(n,l))}else l=o.querySelectorAll(n);if(l.length<=1)return t;const d=e.filter(h=>!t.includes(h));for(const h of d){if(i.scoreElement(h)<ee.MIN_CONFIDENCE_FOR_SKIP)continue;const c=this.insertNodeInOrder(t,h,e),u=this.buildTestSelector(s,c,r);try{let f;if(this.cache){const b=this.cache.getSelectorResults(u);b!==void 0?f=b:(f=Array.from(o.querySelectorAll(u)),this.cache.setSelectorResults(u,f))}else f=o.querySelectorAll(u);if(f.length===1)return c;f.length<l.length&&(t=c)}catch{}}return t}catch{return t}}insertNodeInOrder(e,t,s){const r=s.indexOf(t),i=[...e];let n=0;for(let o=0;o<i.length&&!(s.indexOf(i[o])>r);o++)n=o+1;return i.splice(n,0,t),i}buildTestSelector(e,t,s){const r=[];r.push(this.elementToSelector(e));for(const i of t)r.push(this.elementToSelector(i));return r.push(this.elementToSelector(s)),r.join(" ")}elementToSelector(e){let t=e.tagName.toLowerCase();e.id&&!v(e.id)&&(t+=`#${j(e.id)}`);for(const s of Array.from(e.classList))F(s)||(t+=`.${j(s)}`);return t}filterNoise(e){return e.filter(t=>this.shouldInclude(t))}shouldInclude(e){const t=e.tagName.toLowerCase();return te.includes(t)?!0:t==="div"||t==="span"?this.hasSemanticFeatures(e):!1}hasSemanticFeatures(e){if(e.hasAttribute("role"))return!0;for(const s of Array.from(e.attributes))if(s.name.startsWith("aria-"))return!0;if(e.classList.length>0){for(const s of Array.from(e.classList))if(!F(s))return!0}if(e.hasAttribute("data-testid")||e.hasAttribute("data-qa")||e.hasAttribute("data-test"))return!0;const t=e.id;return!!(t&&!v(t))}isInsideHead(e){let t=e.parentElement;for(;t;){const s=t.tagName.toLowerCase();if(s==="head")return!0;if(s==="body")return!1;t=t.parentElement}return!1}buildHeadPath(e,t,s){const r=[];let i=t.parentElement;for(;i&&i!==e;)r.unshift(i),i=i.parentElement;return i!==e?{path:[],degraded:!0,degradationReason:"target-not-descendant-of-html"}:r.findIndex(n=>n.tagName.toLowerCase()==="head")===-1?{path:[],degraded:!0,degradationReason:"head-not-found-in-path"}:{path:r.map(n=>{const o=n.parentElement;let l;if(o){const d=Array.from(o.children).indexOf(n);d!==-1&&(l=d+1)}return{tag:n.tagName.toLowerCase(),semantics:s.extract(n),score:s.scoreElement(n),nthChild:l}}),degraded:!1}}}function de(a){return a?a.trim().replace(/[\n\t\r]/g," ").replace(/\s+/g," "):""}const he={preserveQueryForAbsolute:!0,removeDynamicHashes:!0};function ue(a){return a?[/\d{5,}/,/[a-f0-9]{8,}/i,/(session|token|temp|random|timestamp|nonce|cache)/i,/^\d+$/,/^[a-f0-9-]{32,}$/i].some(e=>e.test(a)):!1}function fe(a,e){if(!a)return a;const t=a.startsWith("http://")||a.startsWith("https://"),[s,r]=a.split("#"),[i,n]=s.split("?");let o=i;return t&&e.preserveQueryForAbsolute&&n&&(o+=`?${n}`),r&&(e.removeDynamicHashes&&ue(r)||(o+=`#${r}`)),o}function W(a,e,t={}){if(!e)return e;const s={...he,...t};return a==="href"||a==="src"?fe(e,s):e}const me=["role","aria-label","aria-labelledby","aria-describedby","aria-controls","aria-owns","aria-level","aria-posinset","aria-setsize","aria-haspopup"],ge=["aria-selected","aria-checked","aria-pressed","aria-expanded","aria-hidden","aria-disabled","aria-current","aria-busy","aria-invalid","aria-grabbed","aria-live","aria-atomic"],pe=["data-state","data-active","data-inactive","data-selected","data-open","data-closed","data-visible","data-hidden","data-disabled","data-enabled","data-loading","data-error","data-success","data-highlighted","data-focused","data-hover","data-orientation","data-theme"],be=["data-radix-","data-headlessui-","data-reach-","data-mui-","data-chakra-","data-mantine-","data-tw-"],ye=["data-testid","data-test-id","data-test","data-cy","data-qa","data-automation-id","data-id","data-component","data-entity-id","data-product-id","data-user-id"],xe=["data-ga","data-gtm","data-google","data-layer","data-event","data-yandex","data-ym","data-metrika","data-optimizely","data-vwo","data-optimize","data-hj","data-hotjar","data-fs","data-mouseflow","data-mf","data-smartlook","data-sl","data-fb","data-facebook","data-tt","data-li","data-track","data-tracking","data-click","data-impression","data-conversion","data-segment","data-analytics"],Ce=["data-category","data-action","data-label","data-value"],Ae=["id","name","type","placeholder","title","for","alt","href"],ve=["disabled","checked","selected","hidden","readonly","required","value"],we=[/^radix-/,/^headlessui-/,/^mui-/,/:\w+:/];function Ee(a,e){return me.includes(a)?!0:ge.includes(a)||pe.includes(a)||be.some(t=>a.startsWith(t))?!1:ye.includes(a)?!0:xe.some(t=>a.startsWith(t))||Ce.includes(a)?!1:a.startsWith("data-")&&a.endsWith("-id")?!0:a==="id"?!we.some(t=>t.test(e)):Ae.includes(a)?!0:ve.includes(a)?!1:!!a.startsWith("data-")}class q{constructor(e,t){this.includeUtilityClasses=e.includeUtilityClasses??!1,this.cache=t}extract(e){if(this.cache){const n=this.cache.getSemantics(e);if(n!==void 0)return n}const t={},s=e.id;if(s&&!v(s)&&(t.id=s),e.classList.length>0){const n=Array.from(e.classList);if(this.includeUtilityClasses)t.classes=n;else{const{semantic:o}=ce(n);o.length>0&&(t.classes=o)}}const r=this.extractAttributes(e);Object.keys(r).length>0&&(t.attributes=r);const i=e.getAttribute("role");if(i&&(t.role=i),this.shouldExtractText(e)){const n=this.extractText(e);n&&(t.text=n)}return this.cache&&this.cache.setSemantics(e,t),t}scoreElement(e){let t=.5;const s=this.extract(e);return s.id&&(t+=.15),s.classes&&s.classes.length>0&&(t+=.1),s.attributes&&Object.keys(s.attributes).length>0&&(t+=.1),s.role&&(t+=.1),s.text&&(t+=.05),Math.min(t,1)}shouldIgnoreAttribute(e){return!!(_.has(e)||e.startsWith("on")||e.startsWith("ng-")||e.startsWith("_ng")||e.startsWith("data-reactid")||e.startsWith("data-react")||e.startsWith("data-v-"))}getAttributePriority(e){return y[e]!==void 0?y[e]:e.startsWith("data-")?y["data-*"]:e.startsWith("aria-")?y["aria-*"]:0}isDynamicValue(e){return[/^[a-f0-9]{32,}$/i,/^\d{10,}$/,/^(undefined|null|\[object)/,/^{{.*}}$/].some(t=>t.test(e))}extractAttributes(e){const t={};for(const s of Array.from(e.attributes)){const r=s.name;if(this.shouldIgnoreAttribute(r)||!Ee(r,s.value)||O.has(r)&&P(s.value)||this.getAttributePriority(r)===0)continue;const i=r==="href"||r==="src"?W(r,s.value):s.value;!i||i.trim()===""||this.isDynamicValue(i)||(t[r]=i)}return t}extractText(e){const t=this.getDirectTextContent(e);if(!t)return null;const s=de(t);if(!s)return null;const r=100,i=t.length>r?t.slice(0,r)+"...":t,n=s.length>r?s.slice(0,r)+"...":s;return{raw:i,normalized:n}}getDirectTextContent(e){const t=[];for(const s of Array.from(e.childNodes))if(s.nodeType===Node.TEXT_NODE&&s.textContent){const r=s.textContent.trim();r&&t.push(r)}return t.length>0?t.join(" "):e.textContent??null}shouldExtractText(e){const t=e.tagName.toLowerCase();return["button","a","label","h1","h2","h3","h4","h5","h6","p","span","li","th","td","dt","dd","legend","figcaption","summary"].includes(t)}}class Se{fingerprint(e){const t=e.tagName.toLowerCase(),s=this.getShape(t),r={shape:s,hasAnimation:this.hasAnimation(e)};if(s==="path"){const o=e.getAttribute("d");o&&(r.dHash=this.computePathHash(o))}else["circle","rect","ellipse","line"].includes(s)&&(r.geomHash=this.computeGeomHash(e,s));const i=e.getAttribute("role");i&&(r.role=i);const n=e.querySelector("title");return n!=null&&n.textContent&&(r.titleText=n.textContent.trim()),r}computePathHash(e){const t=this.normalizePathData(e);return this.simpleHash(t)}getShape(e){return["path","circle","rect","line","polyline","polygon","ellipse","g","text","use","svg"].find(t=>t===e)??"path"}normalizePathData(e){return(e.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/gi)??[]).slice(0,5).map(t=>t.trim().replace(/(-?\d+\.?\d*)/g,s=>parseFloat(s).toFixed(1))).join(" ")}computeGeomHash(e,t){const s=[];switch(t){case"circle":s.push(`r=${e.getAttribute("r")??"0"}`);break;case"rect":{const r=parseFloat(e.getAttribute("width")??"0"),i=parseFloat(e.getAttribute("height")??"0");r>0&&i>0&&s.push(`ratio=${(r/i).toFixed(2)}`)}break;case"ellipse":{const r=parseFloat(e.getAttribute("rx")??"0"),i=parseFloat(e.getAttribute("ry")??"0");r>0&&i>0&&s.push(`ratio=${(r/i).toFixed(2)}`)}break;case"line":{const r=parseFloat(e.getAttribute("x1")??"0"),i=parseFloat(e.getAttribute("y1")??"0"),n=parseFloat(e.getAttribute("x2")??"0"),o=parseFloat(e.getAttribute("y2")??"0"),l=Math.atan2(o-i,n-r);s.push(`angle=${l.toFixed(2)}`)}break}return this.simpleHash(s.join(";"))}hasAnimation(e){if(e.querySelector("animate, animateTransform, animateMotion"))return!0;const t=e.ownerDocument;if(t!=null&&t.defaultView)try{const s=t.defaultView.getComputedStyle(e);if(s.animationName!=="none"||s.transitionProperty!=="all"&&s.transitionProperty!=="none")return!0}catch{}return!1}simpleHash(e){let t=0;for(let s=0;s<e.length;s++){const r=e.charCodeAt(s);t=(t<<5)-t+r,t=t&t}return Math.abs(t).toString(16).padStart(8,"0")}}function Te(a,e=0){const t=a.anchor.score,s=a.path.length>0?a.path.reduce((o,l)=>o+l.score,0)/a.path.length:.5,r=a.target.score,i=t*E.ANCHOR+s*E.PATH+r*E.TARGET+e*E.UNIQUENESS,n=a.anchor.degraded?.2:0;return Math.max(0,Math.min(1,i-n))}class $e{constructor(e){this.cache=new Map,this.maxSize=e}get(e){const t=this.cache.get(e);if(t!==void 0)return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const s=this.cache.keys().next().value;s!==void 0&&this.cache.delete(s)}this.cache.set(e,t)}has(e){return this.cache.has(e)}delete(e){this.cache.delete(e)}clear(){this.cache.clear()}get size(){return this.cache.size}}class ke{constructor(e={}){this.eidCache=new WeakMap,this.selectorResultCache=new $e(e.maxSelectorCacheSize??1e3),this.anchorCache=new WeakMap,this.semanticsCache=new WeakMap,this.stats={eidHits:0,eidMisses:0,selectorHits:0,selectorMisses:0,anchorHits:0,anchorMisses:0,semanticsHits:0,semanticsMisses:0,selectorCacheSize:0,maxSelectorCacheSize:e.maxSelectorCacheSize??1e3}}getEID(e){const t=this.eidCache.get(e);if(t!==void 0)return this.stats.eidHits++,t;this.stats.eidMisses++}setEID(e,t){this.eidCache.set(e,t)}getSelectorResults(e){const t=this.selectorResultCache.get(e);if(t!==void 0)return this.stats.selectorHits++,this.stats.selectorCacheSize=this.selectorResultCache.size,t;this.stats.selectorMisses++,this.stats.selectorCacheSize=this.selectorResultCache.size}setSelectorResults(e,t){this.selectorResultCache.set(e,t),this.stats.selectorCacheSize=this.selectorResultCache.size}getAnchor(e){if(this.anchorCache.has(e))return this.stats.anchorHits++,this.anchorCache.get(e);this.stats.anchorMisses++}setAnchor(e,t){this.anchorCache.set(e,t)}getSemantics(e){const t=this.semanticsCache.get(e);if(t!==void 0)return this.stats.semanticsHits++,t;this.stats.semanticsMisses++}setSemantics(e,t){this.semanticsCache.set(e,t)}clear(){this.selectorResultCache.clear(),this.stats.selectorCacheSize=0,this.stats={eidHits:0,eidMisses:0,selectorHits:0,selectorMisses:0,anchorHits:0,anchorMisses:0,semanticsHits:0,semanticsMisses:0,selectorCacheSize:0,maxSelectorCacheSize:this.stats.maxSelectorCacheSize}}invalidateElement(e){}invalidateSelector(e){this.selectorResultCache.delete(e),this.stats.selectorCacheSize=this.selectorResultCache.size}getStats(){return{...this.stats,selectorCacheSize:this.selectorResultCache.size}}getEIDHitRate(){const e=this.stats.eidHits+this.stats.eidMisses;return e>0?this.stats.eidHits/e:0}getSelectorHitRate(){const e=this.stats.selectorHits+this.stats.selectorMisses;return e>0?this.stats.selectorHits/e:0}getAnchorHitRate(){const e=this.stats.anchorHits+this.stats.anchorMisses;return e>0?this.stats.anchorHits/e:0}getSemanticsHitRate(){const e=this.stats.semanticsHits+this.stats.semanticsMisses;return e>0?this.stats.semanticsHits/e:0}getOverallHitRate(){const e=this.stats.eidHits+this.stats.selectorHits+this.stats.anchorHits+this.stats.semanticsHits,t=this.stats.eidMisses+this.stats.selectorMisses+this.stats.anchorMisses+this.stats.semanticsMisses,s=e+t;return s>0?e/s:0}}function He(a){return new ke(a)}let k=null;function Le(){return k||(k=He()),k}function De(a,e={}){var X;if(!a||!a.ownerDocument||!a.isConnected)return null;const t={...ae,...e},s=t.cache??Le(),r=s.getEID(a);if(r!==void 0)return r;if(a.tagName.toLowerCase()==="html"){const A=new q(t,s),J=Me(a,t,A);return s.setEID(a,J),J}const i=new se(t,s),n=new le(t,s),o=new q(t,s),l=new Se,d=i.findAnchor(a);if(!d&&!t.fallbackToBody)return null;const h=(d==null?void 0:d.element)??((X=a.ownerDocument)==null?void 0:X.body)??null;if(!h)return null;const c=!d||d.tier==="C",u=h.tagName.toLowerCase(),f=h.parentElement;let b;if(f&&u!=="body"&&u!=="html"){const A=Array.from(f.children).indexOf(h);A!==-1&&(b=A+1)}const Ue=o.extract(h),z={tag:h.tagName.toLowerCase(),semantics:Ue,score:(d==null?void 0:d.score)??p.DEGRADED_SCORE,degraded:c,nthChild:b},M=n.buildPath(h,a,o),K=o.extract(a);t.enableSvgFingerprint&&Re(a)&&(K.svg=l.fingerprint(a));const Q=a.parentElement;let Y;if(Q){const A=Array.from(Q.children).indexOf(a);A!==-1&&(Y=A+1)}const Ge={tag:a.tagName.toLowerCase(),semantics:K,score:o.scoreElement(a),nthChild:Y},Ve=[],Be={onMultiple:"best-score",onMissing:"anchor-only",maxDepth:3},Ze=z.degraded||M.degraded,Ke=ze(z.degraded,M),w={version:"1.0",anchor:z,path:M.path,target:Ge,constraints:Ve,fallback:Be,meta:{confidence:0,generatedAt:new Date().toISOString(),generator:"dom-eid@1.0",source:t.source,degraded:Ze,degradationReason:Ke}};return w.meta.confidence=Te(w),w.meta.confidence<t.confidenceThreshold?null:(s.setEID(a,w),w)}function Re(a){return a.namespaceURI==="http://www.w3.org/2000/svg"||a.tagName.toLowerCase()==="svg"||a instanceof SVGElement}function ze(a,e){if(a&&e.degraded)return"anchor-and-path-degraded";if(a)return"no-semantic-anchor";if(e.degraded)return e.degradationReason}function Me(a,e,t,s){const r={tag:"html",semantics:t.extract(a),score:1,degraded:!1,nthChild:void 0};return{version:"1.0",anchor:r,path:[],target:r,constraints:[],fallback:{onMultiple:"best-score",onMissing:"anchor-only",maxDepth:3},meta:{confidence:1,generatedAt:new Date().toISOString(),generator:"dom-eid@1.0",source:e.source,degraded:!1,degradationReason:void 0}}}const U={maxClasses:2,maxAttributes:5,includeText:!0,maxTextLength:50,simplifyTarget:!0,includeConstraints:!0};function G(a){return a==="id"?101:y[a]!==void 0?y[a]:a.startsWith("data-")?y["data-*"]:a.startsWith("aria-")?y["aria-*"]:0}function Ne(a){return["id","data-testid","data-qa","data-cy","href","text","role"].includes(a)}function Ie(a){return!!(/@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/.test(a)||/(\+?\d{1,3}[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}/.test(a)||/\d{4}[-\s]?\d{4}[-\s]?\d{4}[-\s]?\d{4}/.test(a))}function _e(a,e){const t={...U,...e},s=`v${a.version}`,r=H(a.anchor,!1,t),i=a.path.length>0?a.path.map(l=>H(l,!1,t)).join(" > ")+" > ":"",n=H(a.target,!0,t),o=t.includeConstraints?Oe(a):"";return`${s}: ${r} :: ${i}${n}${o}`}function H(a,e=!1,t=U){const{tag:s,semantics:r}=a;let i=s;const n=[],o={...r.attributes};r.id&&(o.id=r.id),r.role&&!o.role&&(o.role=r.role);const l=Object.entries(o).map(([c,u])=>{const f=G(c),b=c==="href"||c==="src"?W(c,u):u;return{name:c,value:b,priority:f}}).filter(c=>c.name!=="id"&&c.name!=="class"&&_.has(c.name)||O.has(c.name)&&P(c.value)?!1:c.priority>0||c.name==="role"||c.name==="id");l.sort((c,u)=>u.priority-c.priority);const d=l.slice(0,t.maxAttributes);d.sort((c,u)=>c.name.localeCompare(u.name));for(const{name:c,value:u}of d)n.push(`${c}="${L(u)}"`);if(t.includeText&&r.text&&!Ie(r.text.normalized)){const c=r.text.normalized;c.length>0&&c.length<=t.maxTextLength&&n.push(`text="${L(c)}"`)}let h=n;if(n.length>0&&(e&&t.simplifyTarget&&r.id&&(h=n.filter(c=>{const u=c.split("=")[0];return G(u)>=60||u==="text"||u==="id"||u==="role"})),h.length>0&&h.sort((c,u)=>c.localeCompare(u))),r.classes&&r.classes.length>0){const c=oe(r.classes),u=!!r.id||n.some(f=>f.startsWith("href=")||f.startsWith("data-testid=")||f.startsWith("text=")||f.startsWith("role="));if(!(e&&t.simplifyTarget&&u)&&c.length>0){const f=c.sort().slice(0,t.maxClasses);i+=f.map(b=>`.${b}`).join("")}}if(h.length>0&&(i+=`[${h.join(",")}]`),"nthChild"in a&&a.nthChild){const c=!!r.id||r.attributes&&Object.keys(r.attributes).some(Ne);e&&t.simplifyTarget&&c||(i+=`#${a.nthChild}`)}return i}function Oe(a){if(!a.constraints||a.constraints.length===0)return"";const e=[];for(const t of a.constraints)switch(t.type){case"uniqueness":e.push("unique=true");break;case"position":t.params&&t.params.strategy&&e.push(`pos=${t.params.strategy}`);break;case"text-proximity":if(t.params&&t.params.reference){const s=L(String(t.params.reference));e.push(`text="${s}"`)}break}return e.length===0?"":` {${e.join(",")}}`}function L(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/>/g,"\\>").replace(/:/g,"\\:")}function Pe(a,e,t){const s=De(a,e);return s?_e(s,t):null}function V(a,e={},t){if(!a||a.nodeType!==Node.ELEMENT_NODE)return null;try{return Pe(a,e,e)}catch(s){return t&&s instanceof Error&&t(s,a),null}}let x=null,m=null,D=!1;const B=50,Fe=5e3,je=typeof{url:typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:C&&C.tagName.toUpperCase()==="SCRIPT"&&C.src||new URL("google-custom-event-tracker.umd.js",document.baseURI).href}<"u"&&!1,S={mouseUp:!1,mouseDown:!1,click:!0,contextMenu:!0,dblClick:!0,focus:!0,blur:!0,touchStart:!0,touchEnd:!0,touchCancel:!0,input:!0,play:!0,pause:!0,seeked:!0,volumeChange:!0,rateChange:!0};function R(a={}){D=!0;const e={send:t=>{console.log("Event tracked:",t)},captureText:!0,captureSelector:!0,debug:!1,events:{...S,...a.events},...a};console.log(`initTracker: ${JSON.stringify(e)}`),x&&Object.keys(S).forEach(t=>{const s=t==="dblClick"?"dblclick":t==="volumeChange"?"volumechange":t==="rateChange"?"ratechange":t.toLowerCase();document.removeEventListener(s,x,{capture:!0})}),x=t=>{var n;const s=t.target;if(!s)return;const r=t.type==="dblclick"?"dblClick":t.type==="volumechange"?"volumeChange":t.type==="ratechange"?"rateChange":Object.keys(S).find(o=>o.toLowerCase()===t.type);if(!r||!e.events[r])return;const i={type:t.type,tag:s.tagName.toLowerCase(),ts:Date.now()};if(e.captureText&&(i.text=s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement?s.value:((n=s.textContent)==null?void 0:n.trim())||null),e.captureSelector){const o=V(s,e.seqlOptions,e.debug?(l,d)=>{console.error("[GCE Debug] Error generating selector:",l.message,`
Element:`,d)}:void 0);o?i.selector=o:e.debug&&console.warn("[GCE Debug] Selector generation returned null for element:",s)}e.debug&&console.log("[GCE Debug] Event captured:",{eventType:t.type,element:s,payload:i}),e.send(i)},Object.entries(e.events).forEach(([t,s])=>{if(!s)return;const r=t==="dblClick"?"dblclick":t==="volumeChange"?"volumechange":t==="rateChange"?"ratechange":t.toLowerCase();document.addEventListener(r,x,{capture:!0})})}function Z(){if(typeof window>"u")return;m&&clearInterval(m);let a=0;m=setInterval(()=>{if(typeof window>"u"){clearInterval(m),m=null;return}a+=B;const e=window.gtag,t=window.dataLayer,s=Array.isArray(t)&&typeof t.push=="function";if(typeof e=="function"||s){clearInterval(m),m=null,!D&&!x&&R({send:r=>{typeof e=="function"?e("event","ui_event",r):t.push({event:"ui_event",...r})}});return}a>=Fe&&(clearInterval(m),m=null,console.warn("[GCE] gtag did not initialize in time â€” tracking disabled"))},B)}function We(){x&&(Object.keys(S).forEach(a=>{const e=a==="dblClick"?"dblclick":a==="volumeChange"?"volumechange":a==="rateChange"?"ratechange":a.toLowerCase();document.removeEventListener(e,x,{capture:!0})}),x=null),m&&(clearInterval(m),m=null),D=!1}typeof window<"u"&&!je&&Z();const qe={init:R};g._resetTrackerForTests=We,g.buildSelector=V,g.default=qe,g.initTracker=R,g.startAutoInit=Z,Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=google-custom-event-tracker.umd.js.map
